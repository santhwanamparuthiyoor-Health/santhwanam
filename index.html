<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spreadsheet Data Viewer</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background-color: #f2f2f2;
  }
  h2 {
    text-align: center;
    color: #333;
  }
  #search-input {
    width: 100%;
    max-width: 400px;
    margin: 10px auto 20px auto;
    display: block;
    padding: 8px;
    font-size: 16px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    max-width: 100%;
    background: #fff;
  }
  th, td {
    padding: 10px;
    border: 1px solid #ccc;
    text-align: left;
  }
  th {
    background-color: #4CAF50;
    color: white;
  }
  tr:nth-child(even) {
    background-color: #f9f9f9;
  }
  @media screen and (max-width: 600px) {
    table, thead, tbody, th, td, tr {
      display: block;
    }
    th {
      position: sticky;
      top: 0;
    }
    td {
      border: none;
      padding-left: 50%;
      position: relative;
    }
    td::before {
      content: attr(data-label);
      position: absolute;
      left: 10px;
      font-weight: bold;
    }
  }
</style>
</head>
<body>

<h2>Spreadsheet Data Viewer</h2>
<input type="text" id="search-input" placeholder="Search table...">

<table id="data-table">
  <thead>
    <tr id="table-head"></tr>
  </thead>
  <tbody id="table-body"></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyPS3jyQcy9dTA4O2AcYm7rAchxOIr3JR3oY4LARd8Yzfim7rc2vLV92EubS_o9Pu0a/exec";

async function fetchData() {
  try {
    const response = await fetch(API_URL);
    if (!response.ok) throw new Error('Network response was not ok');
    const data = await response.json();

    if (!data || !data.length) {
      document.getElementById('table-body').innerHTML = '<tr><td colspan="10">No data found</td></tr>';
      return;
    }

    const headers = Object.keys(data[0]);

    // Create table headers
    const thead = document.getElementById('table-head');
    thead.innerHTML = '';
    headers.forEach(header => {
      const th = document.createElement('th');
      th.textContent = header;
      thead.appendChild(th);
    });

    // Create table rows
    const tbody = document.getElementById('table-body');
    tbody.innerHTML = '';
    data.forEach(row => {
      const tr = document.createElement('tr');
      headers.forEach(header => {
        const td = document.createElement('td');
        td.textContent = row[header] || '';
        td.setAttribute('data-label', header); // For responsive mobile
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });

  } catch (error) {
    console.error('Error fetching data:', error);
    document.getElementById('table-body').innerHTML = `<tr><td colspan="10">Error fetching data: ${error.message}</td></tr>`;
  }
}

// Filter table on search input
document.getElementById('search-input').addEventListener('keyup', function() {
  const filter = this.value.toLowerCase();
  const rows = document.querySelectorAll('#table-body tr');
  rows.forEach(row => {
    row.style.display = Array.from(row.cells).some(td => 
      td.textContent.toLowerCase().includes(filter)
    ) ? '' : 'none';
  });
});

// Fetch data on page load
fetchData();
</script>

</body>
</html>
